--- a/auto/endian	2023-03-13 16:02:52.113566206 -0400
+++ b/auto/endian	2023-03-13 16:01:50.680751155 -0400
@@ -2,30 +2,50 @@
 # Copyright (C) Andrew Clayton
 # Copyright (C) Nginx, Inc.
 
+case "${NXT_FORCE_ENDIANNESS}" in
+    little)
+        $echo " little endian (forced)"
+        nxt_have=NXT_HAVE_LITTLE_ENDIAN . auto/have
+    ;;
+
+    big)
+        $echo " big endian (forced)"
+        nxt_have=NXT_HAVE_BIG_ENDIAN . auto/have
+    ;;
+
+    "")
+        nxt_feature="endianness"
+        nxt_feature_name=
+        nxt_feature_run=value
+        nxt_feature_incs=
+        nxt_feature_libs=
+        nxt_feature_test="#include <stdint.h>
+                        #include <stdio.h>
+
+                        int main(void) {
+                            int i = 0x11223344;
+                            uint8_t *p;
+
+                            p = (uint8_t *)&i;
+                            if (*p == 0x44)
+                                printf(\"little endian\");
+                            else
+                                printf(\"big endian\");
+                            return 0;
+                        }"
+        . auto/feature
+
+        if [ "$nxt_feature_value" = "little endian" ]; then
+            nxt_have=NXT_HAVE_LITTLE_ENDIAN . auto/have
+        else
+            nxt_have=NXT_HAVE_BIG_ENDIAN . auto/have
+        fi
+    ;;
+
+    *)
+        $echo
+        $echo "$0: error: invalid \"--force-endianness=${NXT_FORCE_ENDIANNESS}\""
+        exit 1
+    ;;
+esac
 
-nxt_feature="endianness"
-nxt_feature_name=
-nxt_feature_run=value
-nxt_feature_incs=
-nxt_feature_libs=
-nxt_feature_test="#include <stdint.h>
-                  #include <stdio.h>
-
-                  int main(void) {
-                      int i = 0x11223344;
-                      uint8_t *p;
-
-                      p = (uint8_t *)&i;
-                      if (*p == 0x44)
-                          printf(\"little endian\");
-                      else
-                          printf(\"big endian\");
-                      return 0;
-                  }"
-. auto/feature
-
-if [ "$nxt_feature_value" = "little endian" ]; then
-    nxt_have=NXT_HAVE_LITTLE_ENDIAN . auto/have
-else
-    nxt_have=NXT_HAVE_BIG_ENDIAN . auto/have
-fi
--- a/auto/options	2023-02-28 09:52:32.000000000 -0500
+++ b/auto/options	2023-03-13 16:05:04.079317070 -0400
@@ -44,6 +44,8 @@
 
 NXT_TESTS=NO
 
+NXT_FORCE_ENDIANNESS=
+
 for nxt_option
 do
     case "$nxt_option" in
@@ -102,6 +104,8 @@
         --test-build-hpux-sendfile)      NXT_TEST_BUILD_HPUX_SENDFILE=YES    ;;
 
         --tests)                         NXT_TESTS=YES                       ;;
+ 
+        --force-endianness=*)            NXT_FORCE_ENDIANNESS="$value" ;;
 
         --help)
             . auto/help
